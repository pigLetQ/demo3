"use strict";var __assign=this&&this.__assign||function(){__assign=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o))e[o]=t[o]}return e};return __assign.apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:true});exports.CollectionBuilder=void 0;var constant_1=require("../common/constant");var error_1=require("../common/error");var util_1=require("../common/util");var Aggregate_1=require("./Aggregate");var Document_1=require("./Document");var Query_1=require("./Query");var CollectionBuilder=function(){function e(t,r){this.collectionName=t;this.options=__assign({maxAddCount:200},r)}e.prototype.add=function(t){if(!(t===null||t===void 0?void 0:t.data)){throw error_1.DbBuildError.invalidParam("data","\u4E0D\u80FD\u4E3A\u7A7A")}if(Array.isArray(t.data)){return this.batchAdd(t)}return util_1.ActionBuilder.buildDocumentAction(constant_1.DocumentAction.create,this.collectionName,t.data)};e.prototype.batchAdd=function(t){if(t.data.length<=0){throw error_1.DbBuildError.invalidParam("data","\u4E0D\u80FD\u4E3A\u7A7A\u6570\u7EC4")}if(t.data.length>this.options.maxAddCount){throw error_1.DbBuildError.invalidParam("data","\u6700\u5927\u957F\u5EA6 ".concat(this.options.maxAddCount))}var r={$create:t.data};if(typeof t.ordered==="boolean"){r.$ordered=t.ordered}return util_1.ActionBuilder.buildDocumentAction(constant_1.DocumentAction.batchCreate,this.collectionName,r)};e.prototype.doc=function(t){return new Document_1.DocumentBuilder(this.collectionName,t)};e.prototype.limit=function(t){return new Query_1.QueryBuilder(this.collectionName).limit(t)};e.prototype.skip=function(t){return new Query_1.QueryBuilder(this.collectionName).skip(t)};e.prototype.where=function(t){return new Query_1.QueryBuilder(this.collectionName).where(t)};e.prototype.projection=function(t){return new Query_1.QueryBuilder(this.collectionName).projection(t)};e.prototype.orderBy=function(t,r){return new Query_1.QueryBuilder(this.collectionName).orderBy(t,r)};e.prototype.aggregate=function(){return new Aggregate_1.AggregateBuilder(this.collectionName)};e.prototype.get=function(){return new Query_1.QueryBuilder(this.collectionName).get()};e.prototype.count=function(){return new Query_1.QueryBuilder(this.collectionName).count()};return e}();exports.CollectionBuilder=CollectionBuilder;