"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.UpdateRequest=void 0;var error_1=require("../common/error");var AbstractCommand_1=require("./AbstractCommand");var Operator_1=require("./Operator");var UpdateRequest=function(){function r(t,s){if(s===void 0){s=""}this.data=t;this.prefix=s}r.prototype.stringify=function(t){t=t||new Operator_1.Operator;for(var s in this.data){var e=this.prefix?"".concat(this.prefix,".").concat(s):s;var i=this.data[s];var n=typeof i;if(i instanceof AbstractCommand_1.AbstractCommand){if(!(i instanceof AbstractCommand_1.UpdateCommand)){throw error_1.DbBuildError.invalidCommand("Command \u4E0D\u662F\u66F4\u65B0\u64CD\u4F5C")}if(i instanceof AbstractCommand_1.QueryUpdateCommand){t.mergeOperator(i.operator,i.stringifyWithKey(e))}else{t.applyOperator(i.operator,e,i.stringify())}}else if(i instanceof Date){t.set(e,i)}else if(n==="number"){t.set(e,i)}else if(n==="boolean"){t.set(e,i)}else if(n==="string"){t.set(e,i)}else if(n==="bigint"){t.set(e,i)}else if(n==="function"){throw error_1.DbBuildError.invalidParam(e,"\u4E0D\u652F\u6301\u51FD\u6570")}else if(n==="symbol"){throw error_1.DbBuildError.invalidParam(e,"\u4E0D\u652F\u6301 symbol")}else if(n==="undefined"){}else if(i===null){t.set(e,i)}else if(Array.isArray(i)){t.set(e,i)}else{var f=new r(i,e);f.stringify(t)}}return t};r.prototype.toJSON=function(){var t=this.stringify();return t.emit()};return r}();exports.UpdateRequest=UpdateRequest;