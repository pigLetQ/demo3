"use strict";var __awaiter=this&&this.__awaiter||function(s,f,r,c){function a(t){return t instanceof r?t:new r(function(i){i(t)})}return new(r||(r=Promise))(function(t,i){function u(n){try{e(c.next(n))}catch(o){i(o)}}function l(n){try{e(c["throw"](n))}catch(o){i(o)}}function e(n){n.done?t(n.value):a(n.value).then(u,l)}e((c=c.apply(s,f||[])).next())})};var __generator=this&&this.__generator||function(s,f){var r={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},c,a,t,i;return i={next:u(0),"throw":u(1),"return":u(2)},typeof Symbol==="function"&&(i[Symbol.iterator]=function(){return this}),i;function u(e){return function(n){return l([e,n])}}function l(e){if(c)throw new TypeError("Generator is already executing.");while(i&&(i=0,e[0]&&(r=0)),r)try{if(c=1,a&&(t=e[0]&2?a["return"]:e[0]?a["throw"]||((t=a["return"])&&t.call(a),0):a.next)&&!(t=t.call(a,e[1])).done)return t;if(a=0,t)e=[e[0]&2,t.value];switch(e[0]){case 0:case 1:t=e;break;case 4:r.label++;return{value:e[1],done:false};case 5:r.label++;a=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(t=r.trys,t=t.length>0&&t[t.length-1])&&(e[0]===6||e[0]===2)){r=0;continue}if(e[0]===3&&(!t||e[1]>t[0]&&e[1]<t[3])){r.label=e[1];break}if(e[0]===6&&r.label<t[1]){r.label=t[1];t=e;break}if(t&&r.label<t[2]){r.label=t[2];r.ops.push(e);break}if(t[2])r.ops.pop();r.trys.pop();continue}e=f.call(s,r)}catch(n){e=[6,n];a=0}finally{c=t=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:true}}};Object.defineProperty(exports,"__esModule",{value:true});exports.createCallFunction=void 0;var error_1=require("./error");var utils_1=require("./utils");var createCallFunction=function(s){var f=s.httpclient;var r=function(c){return __awaiter(void 0,void 0,void 0,function(){var a,t,i,u,l,e,n;return __generator(this,function(o){switch(o.label){case 0:if(!c.name){throw error_1.FaasError.INVALID_PARAM_ERR("name","\u7F3A\u5931")}a={"x-to-function-name":c.name,"x-alipay-cloud-mode":"function"};t="POST";i="/functions/invokeFunction";return[4,f.request({method:t,path:i,data:c.data,headers:a})];case 1:u=o.sent();if(u.status!==200){l=-1;e="";n=u.data;if(n){l=n.errCode,e=n.errMsg;if(n.errDetail){e+="\uFF0C\u8BE6\u60C5\uFF1A".concat(n.errDetail)}}throw error_1.FaasError.SERVER_ERR(l,e,u.requestID,u.status)}return[2,{requestID:u.requestID,result:u.data}]}})})};return(0,utils_1.wrapCallback)(r)};exports.createCallFunction=createCallFunction;