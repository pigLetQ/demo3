var h=function(i,t,n,u){var s=arguments.length,e=s<3?t:u===null?u=Object.getOwnPropertyDescriptor(t,n):u,c;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")e=Reflect.decorate(i,t,n,u);else for(var p=i.length-1;p>=0;p--)if(c=i[p])e=(s<3?c(e):s>3?c(t,n,e):c(t,n))||e;return s>3&&e&&Object.defineProperty(t,n,e),e};var r=function(i,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(i,t)};var f=function(i,t,n,u){function s(e){return e instanceof n?e:new n(function(c){c(e)})}return new(n||(n=Promise))(function(e,c){function p(l){try{o(u.next(l))}catch(w){c(w)}}function m(l){try{o(u["throw"](l))}catch(w){c(w)}}function o(l){l.done?e(l.value):s(l.value).then(p,m)}o((u=u.apply(i,t||[])).next())})};var d=function(i,t){var n={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},u,s,e,c;return c={next:p(0),"throw":p(1),"return":p(2)},typeof Symbol==="function"&&(c[Symbol.iterator]=function(){return this}),c;function p(o){return function(l){return m([o,l])}}function m(o){if(u)throw new TypeError("Generator is already executing.");while(c&&(c=0,o[0]&&(n=0)),n)try{if(u=1,s&&(e=o[0]&2?s["return"]:o[0]?s["throw"]||((e=s["return"])&&e.call(s),0):s.next)&&!(e=e.call(s,o[1])).done)return e;if(s=0,e)o=[o[0]&2,e.value];switch(o[0]){case 0:case 1:e=o;break;case 4:n.label++;return{value:o[1],done:false};case 5:n.label++;s=o[1];o=[0];continue;case 7:o=n.ops.pop();n.trys.pop();continue;default:if(!(e=n.trys,e=e.length>0&&e[e.length-1])&&(o[0]===6||o[0]===2)){n=0;continue}if(o[0]===3&&(!e||o[1]>e[0]&&o[1]<e[3])){n.label=o[1];break}if(o[0]===6&&n.label<e[1]){n.label=e[1];e=o;break}if(e&&n.label<e[2]){n.label=e[2];n.ops.push(o);break}if(e[2])n.ops.pop();n.trys.pop();continue}o=t.call(i,n)}catch(l){o=[6,l];s=0}finally{u=e=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:true}}};import{CollectionBuilder as b}from"@alipay/faas-db-builder";import{WrapCallback as y}from"../decorator";import{ResponseUtil as g}from"../utils";import{Aggregate as v}from"./Aggregate";import{Document as N}from"./Document";import{Query as a}from"./Query";var _=function(){function i(t,n){this.collectionName=t;this.options=n;this.builder=new b(t)}i.prototype.add=function(t){return f(this,void 0,void 0,function(){var n,u,s,e;return d(this,function(c){switch(c.label){case 0:n=this.builder.add(t).options;u="POST";s=this.getDocumentPath(t.data._id);return[4,this.options.httpclient.request({method:u,path:s,data:n})];case 1:e=c.sent();return[2,g.handleResponse(e)]}})})};i.prototype.doc=function(t){return new N(this.collectionName,t,this.options)};i.prototype.limit=function(t){return new a(this.collectionName,this.options).limit(t)};i.prototype.skip=function(t){return new a(this.collectionName,this.options).skip(t)};i.prototype.where=function(t){return new a(this.collectionName,this.options).where(t)};i.prototype.projection=function(t){return new a(this.collectionName,this.options).projection(t)};i.prototype.field=function(t){return new a(this.collectionName,this.options).field(t)};i.prototype.orderBy=function(t,n){return new a(this.collectionName,this.options).orderBy(t,n)};i.prototype.aggregate=function(){return new v(this.collectionName,this.options)};i.prototype.update=function(t){return f(this,void 0,void 0,function(){return d(this,function(n){switch(n.label){case 0:return[4,new a(this.collectionName,this.options).update(t)];case 1:return[2,n.sent()]}})})};i.prototype.updateAndReturn=function(t){return f(this,void 0,void 0,function(){return d(this,function(n){switch(n.label){case 0:return[4,new a(this.collectionName,this.options).updateAndReturn(t)];case 1:return[2,n.sent()]}})})};i.prototype.set=function(t){return f(this,void 0,void 0,function(){return d(this,function(n){switch(n.label){case 0:return[4,new a(this.collectionName,this.options).set(t)];case 1:return[2,n.sent()]}})})};i.prototype.remove=function(){return f(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return[4,new a(this.collectionName,this.options).remove()];case 1:return[2,t.sent()]}})})};i.prototype.get=function(){return f(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return[4,new a(this.collectionName,this.options).get()];case 1:return[2,t.sent()]}})})};i.prototype.count=function(){return f(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return[4,new a(this.collectionName,this.options).count()];case 1:return[2,t.sent()]}})})};i.prototype.getDocumentPath=function(t){return"/".concat(this.options.databaseName||"faas","/").concat(this.collectionName,"?_id=").concat(t||"")};h([y(),r("design:type",Function),r("design:paramtypes",[Object]),r("design:returntype",Promise)],i.prototype,"add",null);h([y(),r("design:type",Function),r("design:paramtypes",[Object]),r("design:returntype",Promise)],i.prototype,"update",null);h([y(),r("design:type",Function),r("design:paramtypes",[Object]),r("design:returntype",Promise)],i.prototype,"updateAndReturn",null);h([y(),r("design:type",Function),r("design:paramtypes",[Object]),r("design:returntype",Promise)],i.prototype,"set",null);h([y(),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",Promise)],i.prototype,"remove",null);h([y(),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",Promise)],i.prototype,"get",null);h([y(),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",Promise)],i.prototype,"count",null);return i}();export{_ as Collection};